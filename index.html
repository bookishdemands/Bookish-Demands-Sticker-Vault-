<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bookish Demands Sticker Vault</title>

  <style>
    :root{
      --bg:#0f0f14;
      --card:#171723;
      --muted:#a9a9b7;
      --text:#f3f3f7;
      --accent:#ff4fa3;
      --accent2:#20e3b2;
      --line:#2a2a3a;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      background:
        radial-gradient(900px 500px at 10% 0%, rgba(255,79,163,.18), transparent 55%),
        radial-gradient(900px 500px at 90% 10%, rgba(32,227,178,.14), transparent 55%),
        radial-gradient(900px 500px at 40% 110%, rgba(255,205,115,.10), transparent 55%),
        var(--bg);
      color:var(--text);
    }
    .wrap{
      max-width: 1150px;
      margin: 0 auto;
      padding: 26px 16px 60px;
    }
    header{
      display:flex;
      flex-wrap:wrap;
      align-items:flex-end;
      justify-content:space-between;
      gap: 14px;
      margin-bottom: 16px;
    }
    h1{
      margin:0;
      font-size: clamp(22px, 3.2vw, 34px);
      letter-spacing:.2px;
    }
    .subtitle{
      color: var(--muted);
      line-height:1.35;
      max-width: 72ch;
      margin-top: 6px;
    }
    .badgeRow{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .badge{
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.08);
      padding: 8px 10px;
      border-radius: 999px;
      color: var(--muted);
      font-size: 12px;
    }
    .badge b{color:var(--text); font-weight:700}
    .grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 16px;
      margin-top: 18px;
    }
    @media (max-width: 940px){
      .grid{grid-template-columns: 1fr}
      .badgeRow{justify-content:flex-start}
    }
    .card{
      background: rgba(255,255,255,.03);
      border: 1px solid rgba(255,255,255,.08);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHead{
      padding: 14px 16px;
      border-bottom: 1px solid rgba(255,255,255,.07);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .cardHead h2{
      margin:0;
      font-size: 14px;
      letter-spacing:.6px;
      text-transform: uppercase;
      color: rgba(243,243,247,.9);
    }
    .mini{
      font-family: var(--mono);
      font-size: 11.5px;
      color: rgba(243,243,247,.85);
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 999px;
      padding: 6px 10px;
      white-space:nowrap;
    }
    .cardBody{padding: 14px 16px 16px}
    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 12px;
    }
    @media (max-width: 520px){
      .row{grid-template-columns: 1fr}
    }
    label{
      display:block;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
    }
    select, input[type="text"], textarea{
      width:100%;
      padding: 10px 11px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.25);
      color: var(--text);
      outline:none;
    }
    textarea{
      min-height: 120px;
      font-family: var(--mono);
      font-size: 12.5px;
      line-height: 1.35;
      resize: vertical;
    }
    .toggle{
      display:flex;
      align-items:flex-start;
      gap: 10px;
      padding: 10px 11px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color: var(--muted);
      user-select:none;
      margin-bottom: 10px;
    }
    .toggle input{width:18px; height:18px; margin-top:2px}
    .buttons{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      margin-top: 8px;
    }
    button{
      border: 0;
      border-radius: 999px;
      padding: 11px 14px;
      font-weight: 750;
      letter-spacing:.15px;
      cursor:pointer;
      color: #0f0f14;
      background: linear-gradient(135deg, var(--accent), #ffcc73);
      box-shadow: 0 10px 25px rgba(255,79,163,.18);
    }
    button.secondary{
      background: rgba(255,255,255,.08);
      color: var(--text);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow:none;
    }
    button.ghost{
      background: transparent;
      color: var(--text);
      border: 1px solid rgba(255,255,255,.18);
      box-shadow:none;
    }
    button:active{transform: translateY(1px)}
    .hint{
      color: var(--muted);
      font-size: 12px;
      margin-top: 10px;
      line-height:1.4;
    }
    .footerNote{
      margin-top: 14px;
      color: var(--muted);
      font-size: 12px;
      line-height:1.5;
    }
    .footerNote b{color: var(--text)}
    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(20,20,30,.92);
      border: 1px solid rgba(255,255,255,.12);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 12px;
      opacity: 0;
      pointer-events:none;
      transition: opacity .18s ease;
      box-shadow: var(--shadow);
      max-width: calc(100vw - 24px);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
      z-index:9999;
    }
    .toast.show{opacity: 1}
    .split{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 680px){
      .split{grid-template-columns: 1fr}
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Bookish Demands Sticker Vault</h1>
        <div class="subtitle">
          Build Ideogram-ready sticker prompts for urban fiction, dark romance, Black paranormal romance, thriller, and fantasy.
          Mix & match icons, “product packaging” themes, spice level, typography rules, and style variations — then generate up to 5 prompts at once.
        </div>
      </div>
      <div class="badgeRow">
        <div class="badge"><b>Output:</b> Prompt + Negative + Notes</div>
        <div class="badge"><b>Modes:</b> Text / Icon / Packaging</div>
        <div class="badge"><b>File:</b> One-page HTML</div>
      </div>
    </header>

    <div class="grid">
      <!-- Inputs -->
      <section class="card">
        <div class="cardHead">
          <h2>Inputs</h2>
          <span class="mini" id="statusPill">Ready</span>
        </div>

        <div class="cardBody">

          <div class="row">
            <div>
              <label for="count">How many prompts?</label>
              <select id="count">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3" selected>3</option>
                <option value="4">4</option>
                <option value="5">5</option>
              </select>
            </div>

            <div>
              <label for="stickerType">Sticker Type</label>
              <select id="stickerType">
                <option value="icon_quote" selected>Icon + Quote</option>
                <option value="icon_only">Icon Only (no text)</option>
                <option value="quote_only">Quote Only (typography sticker)</option>
                <option value="packaging">Packaging Label Sticker (bottle/jar/pad/tag/etc)</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="vibe">Vibe (select “None” to skip)</label>
              <select id="vibe">
                <option value="">None</option>
                <option>Street Luxe Romance</option>
                <option>Dark Romance After Hours</option>
                <option>Black Paranormal Heat</option>
                <option>Thriller — Cold Case Energy</option>
                <option>Fantasy — Divine & Dangerous</option>
                <option>Urban Fiction — Ride or Die</option>
                <option>Soft Life But Savage</option>
                <option>Luxury Reader Baddie</option>
                <option>Intellectual Villain Era</option>
                <option>Midnight Confessions</option>
                <option>Forbidden Attraction</option>
                <option>Jealous Enemy Plot</option>
                <option>Protective Possessive Energy</option>
                <option>Witchy City Glam</option>
                <option>Gothic Neon Noir</option>
              </select>
            </div>

            <div>
              <label for="variation">Variation (mood/style/aesthetic)</label>
              <select id="variation">
                <option value="">None</option>
                <option value="cute_clipart">Cute Flat Clipart</option>
                <option value="bold_vector">Bold Vector Sticker</option>
                <option value="kawaii_goth">Kawaii Goth</option>
                <option value="noir_minimal">Noir Minimal</option>
                <option value="neon_noir">Neon Noir</option>
                <option value="luxury_editorial">Luxury Editorial</option>
                <option value="vintage_label">Vintage Apothecary Label</option>
                <option value="comic_pop">Comic Pop</option>
                <option value="hand_doodle">Hand-Doodle Charm</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="mainObject">Main Object (select “None” to skip)</label>
              <select id="mainObject">
                <option value="">None</option>
                <option>stack of romance books with sparkles</option>
                <option>Kindle e-reader with glowing heart screen</option>
                <option>stiletto heel stepping on an open book (stylized)</option>
                <option>gold chain heart charm over a paperback</option>
                <option>rose wrapped in barbed-wire ribbon</option>
                <option>lip gloss tube with a tiny crown cap</option>
                <option>perfume bottle with smoky aura</option>
                <option>city skyline silhouette with a heart halo</option>
                <option>moon + stars over an open book</option>
                <option>tarot card “THE PLOT TWIST” (original)</option>
                <option>black cat on a stack of books</option>
                <option>mystic candle + book pages (safe stylized)</option>
                <option>hand holding car keys with sparkle</option>
                <option>sneakers with shine highlights + bookmark tag</option>
                <option>dagger through a heart bookmark (stylized)</option>
                <option>cracked heart locket with tiny pages inside</option>
                <option>hourglass with ink spilling into a book</option>
                <option>butterfly with galaxy wings perched on book</option>
              </select>
            </div>

            <div>
              <label for="accents">Accent Set (select “None” to skip)</label>
              <select id="accents">
                <option value="">None</option>
                <option>tiny sparkles + dots</option>
                <option>small hearts + shine highlights</option>
                <option>soft neon glow accents</option>
                <option>light smoke wisps</option>
                <option>gold glitter dots + starbursts</option>
                <option>inky drips (stylized)</option>
                <option>thorn curls + micro hearts</option>
                <option>subtle lightning cracks (fantasy)</option>
                <option>halo glow + tiny stars</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="palette">Palette (select “None” to skip)</label>
              <select id="palette">
                <option value="">None</option>
                <option>Caramel + Gold + Black</option>
                <option>Burgundy + Chocolate + Gold</option>
                <option>Blush + Cocoa + Cream</option>
                <option>Midnight + Neon + Gold</option>
                <option>Plum + Gold + Espresso</option>
                <option>Emerald + Black + Gold</option>
                <option>Cherry Red + Black + Silver</option>
                <option>Lavender + Midnight + Pearl</option>
                <option>Teal + Charcoal + Chrome</option>
                <option>Rose Gold + Mocha + Ivory</option>
                <option>Crimson + Ink + Cream</option>
                <option>Obsidian + Violet + Gold</option>
              </select>
            </div>

            <div>
              <label for="productTheme">Packaging / Product Theme (optional)</label>
              <select id="productTheme">
                <option value="">None</option>
                <option value="pill_bottle">Pill Bottle (non-IV)</option>
                <option value="prescription_pad">Prescription Pad</option>
                <option value="heart_monitor">Heart Monitor Strip</option>
                <option value="toe_tag">Toe Tag (thriller coded)</option>
                <option value="juice_bottle">Juice Bottle (generic)</option>
                <option value="energy_can">Energy Drink Can (generic)</option>
                <option value="candy_wrapper">Candy Wrapper (generic)</option>
                <option value="seasoning">Seasoning Jar (generic)</option>
                <option value="hot_sauce">Hot Sauce Bottle</option>
                <option value="honey_jar">Honey Jar</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="spice">Spice Level (1–5)</label>
              <select id="spice">
                <option value="1">1 — sweet tension</option>
                <option value="2">2 — flirty heat</option>
                <option value="3" selected>3 — spicy vibes</option>
                <option value="4">4 — steamy romance (non-graphic)</option>
                <option value="5">5 — filthy talk energy (non-graphic)</option>
              </select>
            </div>

            <div>
              <label for="bgMode">Background</label>
              <select id="bgMode">
                <option value="transparent" selected>Transparent background</option>
                <option value="solid_white">Solid white background</option>
                <option value="none_specified">Don’t specify</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="border">Sticker Border</label>
              <select id="border">
                <option value="white" selected>White border (recommended)</option>
                <option value="none">No border</option>
              </select>
            </div>

            <div>
              <label for="outline">Outline</label>
              <select id="outline">
                <option value="bold_black" selected>Thick bold outline</option>
                <option value="no_outline">No outline</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="titleText">Title (optional)</label>
              <input id="titleText" type="text" maxlength="60" placeholder='Example: "EMERGENCY ROMANCE SUPPLY"' />
            </div>
            <div>
              <label for="subtitleText">Subtitle (optional)</label>
              <input id="subtitleText" type="text" maxlength="80" placeholder='Example: "99% Delulu • 1% Regret"' />
            </div>
          </div>

          <label class="toggle">
            <input id="blankMode" type="checkbox" />
            <div>
              <b>Blank sticker mode</b> (no quote text at all — useful for icon packs)
            </div>
          </label>

          <label class="toggle">
            <input id="useRandomQuote" type="checkbox" checked />
            <div>
              <b>Use random quote</b> (non-graphic spice; you can still type a quote to override)
            </div>
          </label>

          <div class="row">
            <div>
              <label for="quote">Quote (optional)</label>
              <input id="quote" type="text" maxlength="120" placeholder='Example: "Soft For You. Savage For Them."' />
            </div>
            <div>
              <label for="typoRule">Typography Rules</label>
              <select id="typoRule">
                <option value="on" selected>Enforce: clear legible typography</option>
                <option value="off">Don’t specify typography rules</option>
              </select>
            </div>
          </div>

          <div class="split">
            <div>
              <label for="customQuotes">Custom Quote Bank (optional)</label>
              <textarea id="customQuotes" placeholder="Add your own quotes (one per line). If filled, random quotes will pull from here first."></textarea>
            </div>
            <div>
              <label for="customOptions">Custom Options (optional)</label>
              <textarea id="customOptions" placeholder="Add custom items (one per line). Format:\nVIBE: ...\nPALETTE: ...\nOBJECT: ...\nACCENT: ...\nPRODUCT: ..."></textarea>
              <div class="hint">Tip: Put “VIBE:” lines to expand the Vibe dropdown instantly when you click Generate.</div>
            </div>
          </div>

          <div class="buttons">
            <button id="generateBtn">Generate</button>
            <button class="secondary" id="copyBtn">Copy Prompt</button>
            <button class="ghost" id="randomBtn">Randomize</button>
            <button class="ghost" id="clearBtn">Clear All</button>
          </div>

          <div class="hint">
            Best results: keep stickers original (no brand names/logos/characters). Use <b>Packaging</b> mode for bottle/jar/pad/tag label stickers like your reference.
          </div>
        </div>
      </section>

      <!-- Outputs -->
      <section class="card">
        <div class="cardHead">
          <h2>Outputs</h2>
          <span class="mini" id="housePill">Ideogram-ready ✅</span>
        </div>
        <div class="cardBody">
          <div style="margin-bottom:12px;">
            <label for="promptOut">Prompt</label>
            <textarea id="promptOut" readonly></textarea>
          </div>

          <div style="margin-bottom:12px;">
            <label for="negOut">Negative Prompt</label>
            <textarea id="negOut" readonly></textarea>
          </div>

          <div>
            <label for="notesOut">Export Notes</label>
            <textarea id="notesOut" readonly></textarea>
          </div>

          <div class="footerNote">
            <b>Commercial safety:</b> keep it original — avoid brand names, real book titles, celebrity likeness, and copyrighted characters.
          </div>
        </div>
      </section>
    </div>
  </div>

  <div class="toast" id="toast">Copied!</div>

  <script>
    // ---------- Safe DOM helpers ----------
    function $(id){ return document.getElementById(id); }
    function val(id){ return ($(id) ? $(id).value : ""); }
    function setVal(id, v){ if($(id)) $(id).value = v; }
    function checked(id){ return ($(id) ? $(id).checked : false); }

    function showToast(msg){
      const t = $("toast");
      if(!t) return;
      t.textContent = msg;
      t.classList.add("show");
      setTimeout(()=> t.classList.remove("show"), 1100);
    }
    function setStatus(text){
      const pill = $("statusPill");
      if(pill) pill.textContent = text;
    }

    // ---------- Built-in quote bank (non-graphic, spice-aware vibe) ----------
    const QUOTES_BASE = [
      "He Don’t Play About Me.",
      "Soft For You. Savage For Them.",
      "Love Me Loud.",
      "I Like My Love A Little Dangerous.",
      "Chosen, Not Chased.",
      "Pressure Makes Diamonds.",
      "Hood Love. Real Love.",
      "Built Different. Loved Hard.",
      "Say Less. Love More.",
      "Keep It Cute, Or Keep It Moving.",
      "Main Character, No Apologies.",
      "He’s Trouble & I Like It.",
      "Certified Heart Snatcher.",
      "Loyalty Looks Good On Me.",
      "I’m The Plot Twist.",
      "Energy Expensive.",
      "Mind On Money, Heart On You.",
      "City Lights, Late Nights.",
      "Booked & Busy.",
      "Read Now, Cry Later.",
      "Spicy Chapter Energy.",
      "Good Girl? Depends.",
      "Protective Energy Only.",
      "Hands Off—That’s Mine.",
      "Bad Decisions, Great Chemistry.",
      "Pretty With A Backbone.",
      "Crowned In Confidence.",
      "Respectfully… Try Again."
    ];

    // ---------- Variation presets (mood/style/aesthetic) ----------
    const VARIATIONS = {
      "cute_clipart": "cute flat vector clipart sticker, rounded shapes, clean flat shading, crisp edges, commercial clipart style",
      "bold_vector": "bold vector sticker, thick clean lines, high-contrast shapes, sharp vector clarity, premium sticker look",
      "kawaii_goth": "kawaii goth sticker style, cute + dark contrast, tiny hearts, subtle spooky accents, clean vector finish",
      "noir_minimal": "noir minimal sticker, simple shapes, limited details, strong contrast, modern minimal icon",
      "neon_noir": "neon noir sticker, subtle neon glow accents, dark background-free subject, high contrast highlights",
      "luxury_editorial": "luxury editorial sticker aesthetic, polished highlights, premium glam details, clean upscale feel",
      "vintage_label": "vintage apothecary label sticker style, ornate frame details, aged paper look (still clean), bold readable label text",
      "comic_pop": "comic pop sticker style, punchy outlines, dynamic accent bursts, pop-art energy, clean vector clarity",
      "hand_doodle": "hand-drawn doodle sticker style, thick outline, simple flat shading, charming imperfections (but clean)"
    };

    // ---------- Palette text mapping ----------
    function paletteText(p){
      const map = {
        "Caramel + Gold + Black": "warm caramel browns, gold highlights, deep black accents",
        "Burgundy + Chocolate + Gold": "deep burgundy, rich chocolate browns, gold highlights",
        "Blush + Cocoa + Cream": "soft blush pink, cocoa browns, creamy off-white highlights",
        "Midnight + Neon + Gold": "midnight black, subtle neon accents, gold highlights",
        "Plum + Gold + Espresso": "deep plum, gold highlights, espresso brown accents",
        "Emerald + Black + Gold": "emerald green, deep black, gold highlights",
        "Cherry Red + Black + Silver": "cherry red, deep black, chrome silver highlights",
        "Lavender + Midnight + Pearl": "lavender, midnight navy, pearl highlights",
        "Teal + Charcoal + Chrome": "teal, charcoal gray, chrome highlights",
        "Rose Gold + Mocha + Ivory": "rose gold, mocha browns, ivory highlights",
        "Crimson + Ink + Cream": "crimson, ink-black, creamy off-white highlights",
        "Obsidian + Violet + Gold": "obsidian black, violet glow, gold accents"
      };
      return map[p] || p || "";
    }

    // ---------- Packaging templates ----------
    const PRODUCT_TEMPLATES = {
      "pill_bottle": {
        subject: "cute pill bottle label sticker (no brand), pharmacy-style bottle silhouette",
        extra: "include label panel + small barcode lines + dosage style layout, no real drug names"
      },
      "prescription_pad": {
        subject: "prescription pad paper sticker, tear-off pad silhouette",
        extra: "include RX-style layout lines and checkbox areas, no real patient data, no real doctors"
      },
      "heart_monitor": {
        subject: "heart monitor strip sticker, ECG waveform paper strip",
        extra: "include stylized waveform line, clean minimal medical strip look"
      },
      "toe_tag": {
        subject: "toe tag sticker, thriller-coded evidence tag",
        extra: "include tag hole + string loop, clean readable label blocks"
      },
      "juice_bottle": {
        subject: "juice bottle sticker, generic juice bottle shape",
        extra: "bright label panel, condensation shine, no brand logos"
      },
      "energy_can": {
        subject: "energy drink can sticker, slim aluminum can silhouette",
        extra: "bold label typography, lightning accents, no brand logos"
      },
      "candy_wrapper": {
        subject: "candy wrapper sticker, rectangular wrapper with twisted ends",
        extra: "bold candy label design, shiny foil highlights, no brand logos"
      },
      "seasoning": {
        subject: "seasoning jar sticker, spice shaker bottle",
        extra: "label panel + ingredient style layout, no brand logos"
      },
      "hot_sauce": {
        subject: "hot sauce bottle sticker, glass bottle silhouette",
        extra: "label panel + heat icon accents, glossy shine"
      },
      "honey_jar": {
        subject: "honey jar sticker, cute jar with lid",
        extra: "golden honey fill, drips, label panel, glossy highlights"
      }
    };

    // ---------- Parse custom options ----------
    function parseCustomOptions(text){
      const out = { VIBE:[], PALETTE:[], OBJECT:[], ACCENT:[], PRODUCT:[] };
      const lines = (text || "").split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
      for(const line of lines){
        const m = line.match(/^(VIBE|PALETTE|OBJECT|ACCENT|PRODUCT)\s*:\s*(.+)$/i);
        if(m){
          out[m[1].toUpperCase()].push(m[2].trim());
        }
      }
      return out;
    }

    function addCustomOptionsToSelect(selectId, items){
      const sel = $(selectId);
      if(!sel || !items || !items.length) return;

      const existing = new Set(Array.from(sel.options).map(o=>o.textContent.trim()));
      items.forEach(item=>{
        if(!existing.has(item)){
          const opt = document.createElement("option");
          opt.textContent = item;
          opt.value = item;
          sel.appendChild(opt);
        }
      });
    }

    // ---------- Quotes ----------
    function customQuoteBank(){
      const raw = val("customQuotes");
      if(!raw.trim()) return [];
      return raw.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
    }

    function getRandom(arr){
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function chooseQuote(spiceLevel){
      // If user typed a quote, use it.
      const q = val("quote").trim();
      if(q) return q;

      // If blank mode OR icon-only, we may omit entirely later.
      if(!checked("useRandomQuote")) return "";

      // Prefer custom quotes if provided
      const custom = customQuoteBank();
      const bank = custom.length ? custom : QUOTES_BASE;

      // Spice-aware: keep it non-graphic; just “energy”
      // (We’re not generating explicit acts—only tone.)
      const s = parseInt(spiceLevel, 10) || 3;
      const spicyAdd =
        (s >= 5) ? " (dirty talk energy, non-graphic)" :
        (s === 4) ? " (steamy romance vibe, non-graphic)" :
        (s === 3) ? " (spicy vibe)" :
        (s === 2) ? " (flirty heat)" :
        " (sweet tension)";

      return getRandom(bank) + spicyAdd;
    }

    // ---------- House style rules ----------
    function stickerFinish(borderChoice, outlineChoice, bgMode, variationKey){
      const border =
        (borderChoice === "white") ? "clean white sticker offset border" :
        "no sticker border";
      const outline =
        (outlineChoice === "bold_black") ? "thick bold outline" :
        "no outline";

      const bg =
        (bgMode === "transparent") ? "transparent background" :
        (bgMode === "solid_white") ? "solid white background" :
        "background not specified";

      const varText = variationKey ? (VARIATIONS[variationKey] || "") : "";

      return [
        outline,
        border,
        bg,
        varText,
        "crisp edges, vector-like clarity",
        "clean flat shading",
        "sticker design",
        "high resolution",
        "no brand logos, no watermark"
      ].filter(Boolean).join(", ");
    }

    function typographyRuleText(){
      if(val("typoRule") !== "on") return "";
      return "clear legible typography, centered composition, bold high-contrast text, no distorted letters";
    }

    // ---------- Prompt builder ----------
    function buildSinglePrompt({
      stickerType, vibe, mainObject, accents, palette, productTheme,
      border, outline, bgMode, variation, spiceLevel, title, subtitle,
      blankMode
    }){
      const finish = stickerFinish(border, outline, bgMode, variation);
      const pal = palette ? `color palette: ${paletteText(palette)}` : "";
      const vib = vibe ? `vibe: ${vibe}` : "";
      const acc = accents ? `add accents: ${accents}` : "";

      const typo = typographyRuleText();
      const typoPart = typo ? `Typography: ${typo}.` : "";

      const t = (title || "").trim();
      const st = (subtitle || "").trim();

      // Determine subject for packaging mode
      let subject = "";
      if(stickerType === "packaging"){
        const tpl = PRODUCT_TEMPLATES[productTheme] || null;
        const subj = tpl ? tpl.subject : "packaging label sticker illustration";
        const extra = tpl ? tpl.extra : "";
        subject = `${subj}${mainObject ? ` featuring ${mainObject}` : ""}. ${extra}`.trim();
      } else {
        subject = mainObject ? mainObject : "simple iconic bookish symbol";
      }

      // Quote logic
      let quote = chooseQuote(spiceLevel);
      if(blankMode) quote = "";

      // Compose text rules depending on type
      let textClause = "";
      if(stickerType === "icon_only"){
        textClause = "no text, no words, no captions";
      } else if(stickerType === "quote_only"){
        // quote only: use quote, or if blank mode + quote_only, still allow title/subtitle if provided
        const q = quote || (t ? t : "BOOKISH DEMANDS");
        textClause = `text only sticker: “${q}”`;
      } else if(stickerType === "packaging"){
        // packaging: prioritize title/subtitle; quote optional
        const labelTitle = t || "ROMANCE SUPPLY";
        const labelSub = st || (quote ? quote : "");
        if(labelSub){
          textClause = `label text: title “${labelTitle}”, subtitle “${labelSub}”`;
        } else {
          textClause = `label text: title “${labelTitle}”`;
        }
      } else {
        // icon + quote
        if(quote){
          textClause = `add caption text: “${quote}”`;
        } else {
          textClause = "no caption text";
        }
      }

      // Safety / originality
      const safety = "original design, no trademarks, no brand names, no copyrighted characters";

      // Final prompt sentence (Ideogram-friendly)
      return [
        "Create image:",
        `${finish}.`,
        `${pal ? pal + "." : ""}`,
        `${vib ? vib + "." : ""}`,
        `Main subject: ${subject}.`,
        `${acc ? acc + "." : ""}`,
        `${typoPart}`,
        `${textClause}.`,
        `${safety}.`,
        "Clean commercial sticker clipart look, polished, readable, centered."
      ].filter(Boolean).join(" ");
    }

    // ---------- Build prompt bundle (1–5) ----------
    function buildPromptBundle(){
      // Apply any custom options into dropdowns before reading values
      const custom = parseCustomOptions(val("customOptions"));
      addCustomOptionsToSelect("vibe", custom.VIBE);
      addCustomOptionsToSelect("palette", custom.PALETTE);
      addCustomOptionsToSelect("mainObject", custom.OBJECT);
      addCustomOptionsToSelect("accents", custom.ACCENT);
      // For PRODUCT: we treat as extra entries in productTheme dropdown
      if(custom.PRODUCT && custom.PRODUCT.length){
        const sel = $("productTheme");
        const existing = new Set(Array.from(sel.options).map(o=>o.textContent.trim()));
        custom.PRODUCT.forEach(item=>{
          if(!existing.has(item)){
            const opt = document.createElement("option");
            opt.value = item;      // custom values allowed
            opt.textContent = item;
            sel.appendChild(opt);
          }
        });
      }

      const stickerType = val("stickerType");
      const vibe = val("vibe");
      const mainObject = val("mainObject");
      const accents = val("accents");
      const palette = val("palette");
      const productTheme = val("productTheme");
      const border = val("border");
      const outline = val("outline");
      const bgMode = val("bgMode");
      const variation = val("variation");
      const spiceLevel = val("spice");
      const title = val("titleText");
      const subtitle = val("subtitleText");
      const blankMode = checked("blankMode");

      const count = Math.max(1, Math.min(5, parseInt(val("count"), 10) || 1));

      const prompts = [];
      for(let i=0; i<count; i++){
        const p = buildSinglePrompt({
          stickerType, vibe, mainObject, accents, palette, productTheme,
          border, outline, bgMode, variation, spiceLevel, title, subtitle,
          blankMode
        });
        prompts.push(`Prompt ${i+1}:\n${p}`);
      }

      const negative =
        "photorealistic, blurry, low-res, messy outline, uneven line weight, distorted letters, unreadable text, random extra words, watermark, signature, brand logos, copyrighted characters, celebrity likeness, background scene, busy gradients, harsh shadows, UI elements";

      const notes =
`Export notes:
- Best: PNG
- Background: Transparent (recommended for stickers)
- Size: 2000–3000px
- If background appears: remove background + add outline in Canva (Glow white, blur 0, size up)

Tip:
- Use Packaging mode for bottle/jar/pad/tag label stickers like your reference.
- Keep text short for readability in Ideogram.`;

      return { body: prompts.join("\n\n"), negative, notes };
    }

    // ---------- Actions ----------
    function generate(){
      try{
        const { body, negative, notes } = buildPromptBundle();
        setVal("promptOut", body);
        setVal("negOut", negative);
        setVal("notesOut", notes);
        setStatus("Generated ✅");
        setTimeout(()=>setStatus("Ready"), 900);
      } catch(err){
        setVal("promptOut", "❌ Generator error:\n" + (err?.message || err));
        setStatus("Error ❌");
        showToast("Error — check Prompt box");
      }
    }

    async function copyPrompt(){
      const text = val("promptOut").trim();
      if(!text){ showToast("Generate first"); return; }
      try{
        await navigator.clipboard.writeText(text);
        showToast("Copied");
      } catch(e){
        const ta = $("promptOut");
        ta.focus(); ta.select();
        document.execCommand("copy");
        showToast("Copied");
      }
    }

    function randomizeAll(){
      // Randomize dropdowns while allowing "None" possibilities
      const pick = (id) => {
        const s = $(id);
        if(!s) return;
        s.selectedIndex = Math.floor(Math.random() * s.options.length);
      };

      pick("stickerType");
      pick("vibe");
      pick("variation");
      pick("mainObject");
      pick("accents");
      pick("palette");
      pick("productTheme");
      pick("spice");
      pick("bgMode");

      // Border/outline defaults (good sticker results)
      setVal("border", "white");
      setVal("outline", "bold_black");

      // Random quote ON, clear typed quote, clear title/subtitle
      $("useRandomQuote").checked = true;
      setVal("quote", "");
      setVal("titleText", "");
      setVal("subtitleText", "");

      // Blank mode OFF by default
      $("blankMode").checked = false;

      generate();
      showToast("Randomized");
    }

    function clearAll(){
      // Reset everything (inputs + outputs)
      setVal("count", "3");
      setVal("stickerType", "icon_quote");

      setVal("vibe", "");
      setVal("variation", "");
      setVal("mainObject", "");
      setVal("accents", "");
      setVal("palette", "");
      setVal("productTheme", "");

      setVal("spice", "3");
      setVal("bgMode", "transparent");

      setVal("border", "white");
      setVal("outline", "bold_black");

      $("blankMode").checked = false;
      $("useRandomQuote").checked = true;

      setVal("quote", "");
      setVal("titleText", "");
      setVal("subtitleText", "");

      setVal("customQuotes", "");
      setVal("customOptions", "");

      setVal("promptOut", "");
      setVal("negOut", "");
      setVal("notesOut", "");
      setStatus("Ready");
      showToast("Cleared");
    }

    // ---------- Wire up ----------
    $("generateBtn").addEventListener("click", generate);
    $("copyBtn").addEventListener("click", copyPrompt);
    $("randomBtn").addEventListener("click", randomizeAll);
    $("clearBtn").addEventListener("click", clearAll);

    // Auto-generate on load so you instantly see output
    window.addEventListener("load", generate);
  </script>
</body>
</html>
